<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="AppControlManager.Pages.Home"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:canvas="using:Microsoft.Graphics.Canvas.UI.Xaml"
    xmlns:customUI="using:AppControlManager.CustomUIElements.HomePageCarousel"
    FlowDirection="{x:Bind ViewModel.AppSettings.ApplicationGlobalFlowDirection, Mode=OneWay}"
    xmlns:sys="using:System"
    Loaded="{x:Bind OnInitialLoaded}"
    Unloaded="{x:Bind OnUnloadedDisposeResources}"
    Background="Transparent">

    <Page.Resources>
        <ResourceDictionary>

            <!-- Base Border Style for Cards -->
            <Style x:Key="OverviewCardBorderStyle" TargetType="Border">
                <Setter Property="CornerRadius" Value="8"/>
                <Setter Property="Padding" Value="16"/>
                <Setter Property="Background" Value="{ThemeResource CardBackgroundFillColorDefaultBrush}"/>
                <Setter Property="BorderBrush" Value="{ThemeResource ControlStrokeColorDefaultBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Width" Value="274"/>
                <Setter Property="Height" Value="96"/>
                <Setter Property="Margin" Value="0,0,8,8"/>
            </Style>

            <!-- Grid Layout for Card Content -->
            <Style x:Key="CardContentGridStyle" TargetType="Grid">
                <Setter Property="RowSpacing" Value="8"/>
            </Style>

            <!-- Header Icon Style -->
            <Style x:Key="CardHeaderIconStyle" TargetType="FontIcon">
                <Setter Property="AutomationProperties.AccessibilityView" Value="Raw"/>
                <Setter Property="FontSize" Value="20"/>
                <Setter Property="Foreground" Value="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
            </Style>

            <!-- Header StackPanel Style -->
            <Style x:Key="CardHeaderStackStyle" TargetType="StackPanel">
                <Setter Property="Orientation" Value="Horizontal"/>
                <Setter Property="Spacing" Value="12"/>
            </Style>

            <!-- Header TextBlock Style (inherits from BodyStrong but adds vertical alignment) -->
            <Style x:Key="CardHeaderTextStyle" TargetType="TextBlock" BasedOn="{StaticResource BodyStrongTextBlockStyle}">
                <Setter Property="VerticalAlignment" Value="Center"/>
            </Style>

            <!-- Content/Body TextBlock Style -->
            <Style x:Key="CardBodyTextStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="Foreground" Value="{ThemeResource TextFillColorSecondaryBrush}"/>
                <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                <Setter Property="TextWrapping" Value="Wrap"/>
            </Style>

        </ResourceDictionary>
    </Page.Resources>

    <Grid Background="Transparent">

        <Grid x:Name="BackgroundLayer"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch">
            <!-- Background Web (first child draws behind everything else) -->
            <!-- Force LTR for Win2D coordinate space so RTL does not mirror drawing -->
            <canvas:CanvasControl x:Name="BackgroundCanvas"
                                  FlowDirection="LeftToRight"
                                  ClearColor="Transparent"
                                  Draw="OnBackgroundCanvasDraw"
                                  IsHitTestVisible="False"
                                  HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch"/>
        </Grid>

        <Grid x:Name="ContentLayer"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch">

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <customUI:HeaderCarousel Margin="0,0,0,-12" />

            <!-- Overview-style sections -->
            <ScrollViewer Grid.Row="2">
                <Grid Margin="24,24,24,24">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="36"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- System Overview -->
                    <TextBlock Grid.Row="0"
                               Margin="2,0,0,8"
                               FontSize="16"
                               FontWeight="SemiBold"
                               x:Uid="SystemOverview"
                               TextWrapping="Wrap" />

                    <!-- Using ItemsControl with a VariableSizedWrapGrid to allow direct XAML content and wrap layout -->
                    <ItemsControl Grid.Row="1">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VariableSizedWrapGrid Orientation="Horizontal"
                                                       ItemWidth="274"
                                                       ItemHeight="96"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>

                        <!-- SYSTEM TIME -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE823;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="SystemTime"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.SystemTimeText, Mode=OneWay}"/>
                            </Grid>
                        </Border>

                        <!-- TIME ZONE -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE707;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="TimeZone"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.TimeZoneText, Mode=OneWay}"/>
                            </Grid>
                        </Border>

                        <!-- USER -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE77B;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="User"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.UserKindText, Mode=OneWay}"/>
                            </Grid>
                        </Border>

                        <!-- COMPUTER NAME -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE770;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="ComputerName"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind sys:Environment.MachineName}"
                                           IsTextSelectionEnabled="True"/>
                            </Grid>
                        </Border>

                        <!-- OS INFO -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE9F9;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="OperatingSystem"/>
                                </StackPanel>
                                <ScrollViewer Grid.Row="1"
                                              HorizontalScrollBarVisibility="Disabled"
                                              HorizontalScrollMode="Disabled"
                                              IsVerticalRailEnabled="True"
                                              VerticalScrollBarVisibility="Visible"
                                              VerticalScrollMode="Enabled">
                                    <TextBlock Width="240"
                                               Style="{StaticResource CardBodyTextStyle}"
                                               Text="{x:Bind ViewModel.OsInfoText, Mode=OneWay}"
                                               IsTextSelectionEnabled="True"/>
                                </ScrollViewer>
                            </Grid>
                        </Border>

                        <!-- UPTIME -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE81C;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="Uptime"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.UptimeText, Mode=OneWay}"/>
                            </Grid>
                        </Border>

                        <!-- SYSTEM RAM -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE7F8;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="SystemRAM"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.SystemRamText, Mode=OneWay}"
                                           IsTextSelectionEnabled="True"/>
                            </Grid>
                        </Border>

                        <!-- APP RAM USAGE -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xEAC2;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="AppRAMUsage"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.AppRamText, Mode=OneWay}"/>
                            </Grid>
                        </Border>

                        <!-- STORAGE SIZE -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xEDA2;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="StorageSize"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.DiskSizeText, Mode=OneWay}"/>
                            </Grid>
                        </Border>

                        <!-- INTERNET SPEED -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid RowSpacing="6">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE839;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="InternetSpeed"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.InternetSpeedText, Mode=OneWay}"/>
                                <TextBlock Grid.Row="2"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.InternetTotalText, Mode=OneWay}"/>
                            </Grid>
                        </Border>

                        <!-- CPU -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xEEA1;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               Text="CPU"/>
                                </StackPanel>
                                <ScrollViewer Grid.Row="1"
                                              HorizontalScrollBarVisibility="Disabled"
                                              HorizontalScrollMode="Disabled"
                                              IsVerticalRailEnabled="True"
                                              VerticalScrollBarVisibility="Visible"
                                              VerticalScrollMode="Enabled">
                                    <TextBlock Width="240"
                                               Style="{StaticResource CardBodyTextStyle}"
                                               Text="{x:Bind ViewModel.CpuDetailsText, Mode=OneWay}"
                                               IsTextSelectionEnabled="True"/>
                                </ScrollViewer>
                            </Grid>
                        </Border>

                        <!-- CPU TEMPERATURE -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE9CA;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="CPUTemperature"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.CpuTemperatureText, Mode=OneWay}"/>
                            </Grid>
                        </Border>

                    </ItemsControl>

                    <!-- spacer between sections -->
                    <TextBlock Grid.Row="2" Text="" />

                    <!-- Online Microsoft Defender Status -->
                    <TextBlock Grid.Row="3"
                               Margin="2,0,0,8"
                               FontSize="16"
                               FontWeight="SemiBold"
                               x:Uid="OnlineMicrosoftDefenderStatus"
                               TextWrapping="Wrap" />

                    <!-- Using ItemsControl here as well -->
                    <ItemsControl Grid.Row="4">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VariableSizedWrapGrid Orientation="Horizontal"
                                                       ItemWidth="274"
                                                       ItemHeight="96"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>

                        <!-- ENGINE VERSION -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE7EF;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="EngineVersion"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.EngineVersionText, Mode=OneWay}"
                                           IsTextSelectionEnabled="True"/>
                            </Grid>
                        </Border>

                        <!-- SIGNATURE VERSION -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE8A5;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="SignatureVersion"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.SignatureVersionText, Mode=OneWay}"
                                           IsTextSelectionEnabled="True"/>
                            </Grid>
                        </Border>

                        <!-- PLATFORM VERSION -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE7F8;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="PlatformVersion"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.PlatformVersionText, Mode=OneWay}"
                                           IsTextSelectionEnabled="True"/>
                            </Grid>
                        </Border>

                        <!-- UPDATE DATE (UTC) -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}">
                            <Grid Style="{StaticResource CardContentGridStyle}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Style="{StaticResource CardHeaderStackStyle}">
                                    <FontIcon Style="{StaticResource CardHeaderIconStyle}"
                                              Glyph="&#xE823;"/>
                                    <TextBlock Style="{StaticResource CardHeaderTextStyle}"
                                               x:Uid="SignatureUpdate"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource CardBodyTextStyle}"
                                           Text="{x:Bind ViewModel.SignatureUpdateDateText, Mode=OneWay}"
                                           IsTextSelectionEnabled="True"/>
                            </Grid>
                        </Border>
                    </ItemsControl>
                </Grid>
            </ScrollViewer>
        </Grid>
    </Grid>
</Page>
