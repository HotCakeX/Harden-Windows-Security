<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="AppControlManager.Pages.Home"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:canvas="using:Microsoft.Graphics.Canvas.UI.Xaml"
    xmlns:customUI="using:HardenSystemSecurity.CustomUIElements.HomePageCarousel"
    FlowDirection="{x:Bind ViewModel.AppSettings.ApplicationGlobalFlowDirection, Mode=OneWay}"
    Loaded="{x:Bind OnInitialLoaded}"
    Unloaded="{x:Bind OnUnloadedDisposeResources}"
    Background="Transparent">

    <Page.Resources>

        <ResourceDictionary>
            <!-- Card visuals used for information items -->
            <Style x:Key="OverviewCardBorderStyle" TargetType="Border">
                <Setter Property="CornerRadius" Value="8"/>
                <Setter Property="Padding" Value="16"/>
                <Setter Property="Background" Value="{ThemeResource CardBackgroundFillColorDefaultBrush}"/>
                <Setter Property="BorderBrush" Value="{ThemeResource ControlStrokeColorDefaultBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
            </Style>
        </ResourceDictionary>
    </Page.Resources>
    <Grid Background="Transparent">

        <Grid x:Name="BackgroundLayer"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch">
            <!-- Background Web (first child draws behind everything else) -->
            <!-- Force LTR for Win2D coordinate space so RTL does not mirror drawing -->
            <canvas:CanvasControl x:Name="BackgroundCanvas"
                                          FlowDirection="LeftToRight"
                                          ClearColor="Transparent"
                                          Draw="OnBackgroundCanvasDraw"
                                          IsHitTestVisible="False"
                                          HorizontalAlignment="Stretch"
                                          VerticalAlignment="Stretch"/>
        </Grid>

        <Grid x:Name="ContentLayer"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch">

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <customUI:HeaderCarousel Margin="0,0,0,-12" />

            <!-- Overview-style sections -->
            <ScrollViewer Grid.Row="2">
                <Grid Margin="24,24,24,24">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="36"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Section 1: System Overview -->
                    <TextBlock
                        Grid.Row="0"
                        Margin="2,0,0,8"
                        FontSize="16"
                        FontWeight="SemiBold"
                        Text="System Overview"
                        TextWrapping="Wrap" />

                    <!-- Using ItemsControl with a VariableSizedWrapGrid to allow direct XAML content and wrap layout -->
                    <ItemsControl Grid.Row="1">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VariableSizedWrapGrid Orientation="Horizontal"
                                                       ItemWidth="274"
                                                       ItemHeight="96"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>

                        <!-- SYSTEM TIME -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE823;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="System Time"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.SystemTimeText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- TIME ZONE -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE707;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="Time Zone"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.TimeZoneText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- USER -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE77B;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="User"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.UserKindText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- UPTIME -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE81C;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="Uptime"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.UptimeText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- SYSTEM RAM -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE7F8;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="System RAM"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.SystemRamText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- APP RAM -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xEAC2;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="App RAM"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.AppRamText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- DISK SIZE -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xEDA2;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="Disk Size"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.DiskSizeText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- INTERNET SPEED -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE839;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="Internet Speed"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.InternetSpeedText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>
                    </ItemsControl>

                    <!-- spacer between sections -->
                    <TextBlock Grid.Row="2" Text="" />

                    <!-- Section 2: Online Microsoft Defender Status -->
                    <TextBlock
                        Grid.Row="3"
                        Margin="2,0,0,8"
                        FontSize="16"
                        FontWeight="SemiBold"
                        Text="Online Microsoft Defender Status"
                        TextWrapping="Wrap" />

                    <!-- Using ItemsControl here as well -->
                    <ItemsControl Grid.Row="4">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VariableSizedWrapGrid Orientation="Horizontal"
                                                       ItemWidth="274"
                                                       ItemHeight="96"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>

                        <!-- ENGINE VERSION -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE7EF;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="Engine Version"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.EngineVersionText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- SIGNATURE VERSION -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE8A5;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="Signature Version"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.SignatureVersionText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- PLATFORM VERSION -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE7F8;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="Platform Version"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.PlatformVersionText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- UPDATE DATE (UTC) -->
                        <Border Style="{StaticResource OverviewCardBorderStyle}" Width="274" Height="96" Margin="0,0,8,8">
                            <Grid RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon
                                        AutomationProperties.AccessibilityView="Raw"
                                        FontSize="20"
                                        Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                        Glyph="&#xE823;"/>
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BodyStrongTextBlockStyle}"
                                        Text="Signature Update (UTC)"/>
                                </StackPanel>
                                <TextBlock
                                    Grid.Row="1"
                                    FontSize="12"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    Text="{x:Bind ViewModel.SignatureUpdateDateText, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap"/>
                            </Grid>
                        </Border>
                    </ItemsControl>
                </Grid>
            </ScrollViewer>
        </Grid>
    </Grid>
</Page>
