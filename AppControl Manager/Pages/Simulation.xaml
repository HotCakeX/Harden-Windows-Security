<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="AppControlManager.Pages.Simulation"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:localbase="using:AppControlManager"
    xmlns:AppControlManager="using:AppControlManager"
    xmlns:customUI="using:AppControlManager.CustomUIElements"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:others="using:AppControlManager.Others"
    FlowDirection="{x:Bind ViewModel.AppSettings.ApplicationGlobalFlowDirection, Mode=OneWay}">

    <Grid TabFocusNavigation="Cycle">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <customUI:InfoBarV2 Grid.Row="0"
                            IsOpen="{x:Bind ViewModel.MainInfoBarIsOpen, Mode=TwoWay}"
                            Message="{x:Bind ViewModel.MainInfoBarMessage, Mode=OneWay}"
                            Severity="{x:Bind ViewModel.MainInfoBarSeverity, Mode=OneWay}"
                            IsClosable="{x:Bind ViewModel.MainInfoBarIsClosable, Mode=OneWay}" />

        <Expander HorizontalAlignment="Stretch"
                  Grid.Row="1"
                  Margin="0,5,0,10">
            <Expander.Header>

                <controls:WrapPanel Style="{StaticResource UnifiedToolbarStyle}">

                    <!-- Begin Simulation Button -->
                    <Button x:Uid="BeginSimulation"
                        Style="{StaticResource AccentButtonStyle}"
                        IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}"
                        Click="{x:Bind ViewModel.BeginSimulationButton_Click}">
                        <StackPanel Orientation="Horizontal">
                            <SymbolIcon Symbol="Play" />
                            <TextBlock x:Uid="BeginSimulationTextBlock" Margin="5,0,0,0"/>
                        </StackPanel>
                    </Button>

                    <!-- Select XML File Button -->
                    <customUI:ButtonV2 Click="{x:Bind ViewModel.SelectXmlFileButton_Click}"
                                       ObservedData="{x:Bind ViewModel.XmlFilePath, Mode=OneWay}"
                                       IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}"
                                       x:Uid="SelectAppControlPolicyFileButton">

                        <Button.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xEC50;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </Button.ContentTemplate>

                        <customUI:ButtonV2.Flyout>
                            <Flyout>

                                <controls:WrapPanel Orientation="Vertical" HorizontalSpacing="15" VerticalSpacing="15">

                                    <Button x:Uid="ClearButton" Click="{x:Bind ViewModel.SelectXmlFileButton_Flyout_Clear_Click}">
                                        <Button.ContentTemplate>
                                            <DataTemplate x:DataType="x:String">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <FontIcon Glyph="&#xE894;" FontSize="16"/>
                                                    <TextBlock Text="{x:Bind}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </Button.ContentTemplate>
                                    </Button>

                                    <TextBlock x:Uid="ViewSelectedXMLFileTextBlock" TextWrapping="WrapWholeWords" />

                                    <TextBox Text="{x:Bind ViewModel.XmlFilePath, Mode=OneWay}"
                                             TextWrapping="Wrap" AcceptsReturn="True" IsSpellCheckEnabled="False"
                                             MinWidth="400" IsReadOnly="True" />

                                </controls:WrapPanel>

                            </Flyout>
                        </customUI:ButtonV2.Flyout>

                    </customUI:ButtonV2>

                    <!-- Select Files Button -->
                    <customUI:ButtonV2 Click="{x:Bind ViewModel.SelectFilesButton_Click}"
                                       IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}"
                                       ObservedData="{x:Bind ViewModel.FilePaths.Count, Mode=OneWay}"
                                       x:Uid="SelectFilesForSimulationButton">

                        <Button.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xEC50;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </Button.ContentTemplate>

                        <customUI:ButtonV2.Flyout>
                            <Flyout>

                                <controls:WrapPanel Orientation="Vertical" HorizontalSpacing="15" VerticalSpacing="15">

                                    <Button x:Uid="ClearButton" Click="{x:Bind ViewModel.SelectFilesButton_Flyout_Clear_Click}">
                                        <Button.ContentTemplate>
                                            <DataTemplate x:DataType="x:String">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <FontIcon Glyph="&#xE894;" FontSize="16"/>
                                                    <TextBlock Text="{x:Bind}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </Button.ContentTemplate>
                                    </Button>

                                    <TextBlock x:Uid="ViewSelectedFilesTextBlock" TextWrapping="WrapWholeWords" />

                                    <customUI:ListBoxV2 MinWidth="400"
                                                        SelectionMode="Single"
                                                        ItemsSource="{x:Bind ViewModel.FilePaths, Mode=OneWay}" />

                                </controls:WrapPanel>

                            </Flyout>
                        </customUI:ButtonV2.Flyout>

                    </customUI:ButtonV2>

                    <!-- Select Folders Button -->
                    <customUI:ButtonV2 Click="{x:Bind ViewModel.SelectFoldersButton_Click}"
                                       IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}"
                                       ObservedData="{x:Bind ViewModel.FolderPaths.Count, Mode=OneWay}"
                                       x:Uid="SelectFoldersForSimulationButton">

                        <Button.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xED25;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </Button.ContentTemplate>

                        <customUI:ButtonV2.Flyout>
                            <Flyout>

                                <controls:WrapPanel Orientation="Vertical" HorizontalSpacing="15" VerticalSpacing="15">

                                    <Button x:Uid="ClearButton" Click="{x:Bind ViewModel.SelectFoldersButton_Flyout_Clear_Click}">
                                        <Button.ContentTemplate>
                                            <DataTemplate x:DataType="x:String">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <FontIcon Glyph="&#xE894;" FontSize="16"/>
                                                    <TextBlock Text="{x:Bind}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </Button.ContentTemplate>
                                    </Button>

                                    <TextBlock x:Uid="ViewSelectedFoldersTextBlock" TextWrapping="WrapWholeWords" />

                                    <customUI:ListBoxV2 MinWidth="400"
                                                        SelectionMode="Single"
                                                        ItemsSource="{x:Bind ViewModel.FolderPaths, Mode=OneWay}" />

                                </controls:WrapPanel>

                            </Flyout>
                        </customUI:ButtonV2.Flyout>

                    </customUI:ButtonV2>

                    <DropDownButton x:Uid="ExtraActionsDropDownButton"
                                    IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}">
                        <DropDownButton.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE712;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </DropDownButton.ContentTemplate>
                        <DropDownButton.Flyout>

                            <MenuFlyout Placement="Bottom">

                                <!-- Cat Root Paths Button -->
                                <MenuFlyoutItem x:Uid="SelectSecurityCatalogsMenuFlyoutItem"
                                                Click="{x:Bind ViewModel.CatRootPathsButton_Click}">
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xED25;"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>

                                <MenuFlyoutSeparator/>

                                <!-- Toggle Button for Security Catalog Scanning -->
                                <ToggleMenuFlyoutItem IsChecked="{x:Bind ViewModel.ScanSecurityCatalogs, Mode=TwoWay}"
                                                      x:Uid="ScanSecurityCatalogsMenuFlyoutItem">
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xEB95;" />
                                    </MenuFlyoutItem.Icon>
                                </ToggleMenuFlyoutItem>

                                <MenuFlyoutSeparator/>

                                <!-- Clear Data Button -->
                                <MenuFlyoutItem Click="{x:Bind ViewModel.ClearDataButton_Click}"
                                                x:Uid="ClearDataMenuFlyoutItem">
                                    <MenuFlyoutItem.Icon>
                                        <SymbolIcon Symbol="Delete" />
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>

                            </MenuFlyout>

                        </DropDownButton.Flyout>
                    </DropDownButton>

                    <!-- Scalability Button with RadialGauge Flyout -->
                    <Button Content="{x:Bind ViewModel.ScalabilityButtonContent, Mode=OneWay}"
                            IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}"
                            x:Uid="ScalabilityButton">
                        <Button.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE9CA;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </Button.ContentTemplate>
                        <Button.Flyout>
                            <Flyout>
                                <StackPanel>
                                    <customUI:ColorRadialGaugeV2
                                      StepSize="1"
                                      IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}"
                                      TickSpacing="2"
                                      ScaleWidth="12"
                                      NeedleWidth="0"
                                      NeedleLength="0"
                                      TickLength="8"
                                      TickWidth="0"
                                      ScalePadding="5"
                                      TickPadding="24"
                                      Width="200"
                                      Maximum="120"
                                      Minimum="2"
                                      Value="{x:Bind ViewModel.ScalabilityRadialGaugeValue, Mode=TwoWay}"
                                      ValueStringFormat="N0"/>
                                </StackPanel>
                            </Flyout>
                        </Button.Flyout>
                    </Button>

                    <ProgressRing IsIndeterminate="False"
                                  Background="LightGray"
                                  Value="{x:Bind ViewModel.ProgressRingValue, Mode=OneWay}" />

                    <!-- Total chip -->
                    <Border CornerRadius="8"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            Padding="10,6"
                            BorderThickness="1"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                        <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
                            <FontIcon Glyph="&#xE8A9;" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" />
                            <TextBlock VerticalAlignment="Center">
                                <Run x:Uid="TotalText" />
                                <Run Text="{x:Bind ViewModel.SimulationOutputs.Count, Mode=OneWay}" FontWeight="SemiBold" />
                            </TextBlock>
                        </StackPanel>
                    </Border>

                    <TextBox PlaceholderText="Search in the data..."
                             IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}"
                             Text="{x:Bind ViewModel.SearchBoxTextBox, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             TextChanged="{x:Bind ViewModel.SearchBox_TextChanged}"
                             VerticalAlignment="Center"
                             VerticalContentAlignment="Center"
                             ToolTipService.ToolTip="Search the data" />

                    <!-- Columns Selection Button -->
                    <customUI:ColumnSelector ItemsSource="{x:Bind ViewModel.ColumnManager.ColumnSelectionItems, Mode=OneWay}"
                                             IsEnabled="{x:Bind ViewModel.AreElementsEnabled, Mode=OneWay}" />

                </controls:WrapPanel>

            </Expander.Header>

            <Expander.Content>

                <controls:WrapPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center" HorizontalSpacing="10" VerticalSpacing="10">

                    <Button Click="{x:Bind ViewModel.ExportToJsonButton_Click}"
                            x:Uid="ExportToJSONButton">
                        <Button.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE96A;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </Button.ContentTemplate>
                    </Button>

                </controls:WrapPanel>

            </Expander.Content>
        </Expander>

        <customUI:ListViewV2 RegistryKey="Simulation"
                             ItemsSource="{x:Bind ViewModel.SimulationOutputs, Mode=OneWay}"
                             Grid.Row="2"
                             SelectionMode="Extended">

            <customUI:ListViewV2.Header>

                <Border CornerRadius="5" Background="Black" customUI:StickyHeaderBehaviorV2.IsEnabled="True">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <!-- Binding Mode must be TwoWay for resizing to work from UI back to ViewModel. Binding to .Width property prevents CollectionChanged re-entrancy. -->
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[0].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[1].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[2].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[3].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[4].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[5].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[6].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[7].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[8].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[9].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[10].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[11].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[12].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[13].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.ColumnManager.ColumnWidths[14].Width, Mode=TwoWay}" />
                        </Grid.ColumnDefinitions>

                        <!-- Header Buttons -->
                        <Button x:Uid="PathColumnHeaderBtn" Grid.Column="0" Margin="10,0,0,0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="Path" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[0], Mode=OneWay}"/>
                        <Button x:Uid="SourceColumnHeaderBtn" Grid.Column="1" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="Source" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[1], Mode=OneWay}"/>
                        <Button x:Uid="IsAuthorizedColumnHeaderBtn" Grid.Column="2" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="IsAuthorized" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[2], Mode=OneWay}"/>
                        <Button x:Uid="MatchCriteriaColumnHeaderBtn" Grid.Column="3" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="MatchCriteria" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[3], Mode=OneWay}"/>
                        <Button x:Uid="SpecificFileNameLevelMatchCriteriaColumnHeaderBtn" Grid.Column="4" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="SpecificFileNameLevelMatchCriteria" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[4], Mode=OneWay}"/>
                        <Button x:Uid="SignerIDColumnHeaderBtn" Grid.Column="5" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="SignerID" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[5], Mode=OneWay}"/>
                        <Button x:Uid="SignerNameColumnHeaderBtn" Grid.Column="6" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="SignerName" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[6], Mode=OneWay}"/>
                        <Button x:Uid="SignerCertRootColumnHeaderBtn" Grid.Column="7" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="SignerCertRoot" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[7], Mode=OneWay}"/>
                        <Button x:Uid="SignerCertPublisherColumnHeaderBtn" Grid.Column="8" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="SignerCertPublisher" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[8], Mode=OneWay}"/>
                        <Button x:Uid="SignerScopeColumnHeaderBtn" Grid.Column="9" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="SignerScope" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[9], Mode=OneWay}"/>
                        <Button x:Uid="CertSubjectCNColumnHeaderBtn" Grid.Column="10" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="CertSubjectCN" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[10], Mode=OneWay}"/>
                        <Button x:Uid="CertIssuerCNColumnHeaderBtn" Grid.Column="11" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="CertIssuerCN" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[11], Mode=OneWay}"/>
                        <Button x:Uid="CertNotAfterColumnHeaderBtn" Grid.Column="12" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="CertNotAfter" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[12], Mode=OneWay}"/>
                        <Button x:Uid="CertTBSValueColumnHeaderBtn" Grid.Column="13" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="CertTBSValue" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[13], Mode=OneWay}"/>
                        <Button x:Uid="FilePathColumnHeaderBtn" Grid.Column="14" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Tag="FilePath" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click}" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[14], Mode=OneWay}"/>

                        <!-- GridSplitters between columns -->
                        <controls:GridSplitter Grid.Column="1" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[16], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="2" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[17], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="3" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[18], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="4" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[19], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="5" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[20], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="6" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[21], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="7" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[22], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="8" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[23], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="9" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[24], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="10" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[25], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="11" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[26], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="12" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[27], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="13" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[28], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="14" Visibility="{x:Bind ViewModel.ColumnManager.ColumnVisibilities[29], Mode=OneWay}" />
                    </Grid>
                </Border>
            </customUI:ListViewV2.Header>

            <!-- DataTemplate for ListView items -->
            <customUI:ListViewV2.ItemTemplate>
                <DataTemplate x:DataType="others:SimulationOutput" xmlns:VMs="using:AppControlManager.ViewModels">
                    <!-- Setting Background="Transparent" on the Grid makes it hit-test visible, meaning that even areas without any child elements (like empty spaces in the column) will respond to pointer events.  -->
                    <Grid Background="Transparent">
                        <Grid.ContextFlyout>
                            <MenuFlyout>

                                <MenuFlyoutItem x:Uid="CopyRow" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopySelectedPolicies_Click}">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Key="C" Modifiers="Control" Invoked="{x:Bind VMs:ViewModelProvider.SimulationVM.CopySelectedPolicies_Click}"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xE8C8;" />
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>

                                <MenuFlyoutSubItem x:Uid="CopyIndividualItems">
                                    <MenuFlyoutSubItem.Icon>
                                        <FontIcon Glyph="&#xE8C8;" />
                                    </MenuFlyoutSubItem.Icon>

                                    <MenuFlyoutSubItem.Items>

                                        <MenuFlyoutItem x:Uid="PathHeader" Tag="Path" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SourceHeader" Tag="Source" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="IsAuthorizedHeader" Tag="IsAuthorized" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="MatchCriteriaHeader" Tag="MatchCriteria" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SpecificFileNameLevelMatchCriteriaHeader" Tag="SpecificFileNameLevelMatchCriteria" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SignerIDHeader" Tag="SignerID" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SignerNameHeader" Tag="SignerName" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SignerCertRootHeader" Tag="SignerCertRoot" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SignerCertPublisherHeader" Tag="SignerCertPublisher" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SignerScopeHeader" Tag="SignerScope" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="CertSubjectCNHeader" Tag="CertSubjectCN" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="CertIssuerCNHeader" Tag="CertIssuerCN" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="CertNotAfterHeader" Tag="CertNotAfter" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="CertTBSValueHeader" Tag="CertTBSValue" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="FilePathHeader" Tag="FilePath" Click="{x:Bind VMs:ViewModelProvider.SimulationVM.CopyPolicyProperty_Click}">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                    </MenuFlyoutSubItem.Items>

                                </MenuFlyoutSubItem>
                            </MenuFlyout>
                        </Grid.ContextFlyout>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[0].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[1].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[2].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[3].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[4].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[5].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[6].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[7].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[8].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[9].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[10].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[11].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[12].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[13].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnWidths[14].Width, Mode=OneWay}" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="{x:Bind Path}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="0" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[0], Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind Source}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="1" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[1], Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind IsAuthorized}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="2" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[2], Mode=OneWay}"/>
                        <TextBlock x:Phase="1" Text="{x:Bind MatchCriteria}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="3" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[3], Mode=OneWay}"/>
                        <TextBlock x:Phase="1" Text="{x:Bind SpecificFileNameLevelMatchCriteria}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="4" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[4], Mode=OneWay}"/>
                        <TextBlock x:Phase="1" Text="{x:Bind SignerID}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="5" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[5], Mode=OneWay}"/>
                        <TextBlock x:Phase="2" Text="{x:Bind SignerName}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="6" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[6], Mode=OneWay}"/>
                        <TextBlock x:Phase="2" Text="{x:Bind SignerCertRoot}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="7" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[7], Mode=OneWay}"/>
                        <TextBlock x:Phase="3" Text="{x:Bind SignerCertPublisher}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="8" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[8], Mode=OneWay}"/>
                        <TextBlock x:Phase="3" Text="{x:Bind SignerScope}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="9" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[9], Mode=OneWay}"/>
                        <TextBlock x:Phase="3" Text="{x:Bind CertSubjectCN}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="10" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[10], Mode=OneWay}"/>
                        <TextBlock x:Phase="3" Text="{x:Bind CertIssuerCN}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="11" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[11], Mode=OneWay}"/>
                        <TextBlock x:Phase="4" Text="{x:Bind CertNotAfter}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="12" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[12], Mode=OneWay}"/>
                        <TextBlock x:Phase="4" Text="{x:Bind CertTBSValue}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="13" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[13], Mode=OneWay}"/>
                        <TextBlock x:Phase="4" Text="{x:Bind FilePath}" FontFamily="{x:Bind VMs:ViewModelProvider.SimulationVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="14" Visibility="{x:Bind VMs:ViewModelProvider.SimulationVM.ColumnManager.ColumnVisibilities[14], Mode=OneWay}"/>
                    </Grid>
                </DataTemplate>
            </customUI:ListViewV2.ItemTemplate>
        </customUI:ListViewV2>

    </Grid>
</Page>