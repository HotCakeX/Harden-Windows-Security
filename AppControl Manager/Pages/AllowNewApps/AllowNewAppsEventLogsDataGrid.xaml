<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="AppControlManager.Pages.AllowNewAppsEventLogsDataGrid"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:customUI="using:AppControlManager.CustomUIElements"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:intelgathering="using:AppControlManager.IntelGathering"
    xmlns:others="using:AppControlManager.Others"
    FlowDirection="{x:Bind ViewModel.AppSettings.ApplicationGlobalFlowDirection, Mode=OneWay}">

    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Expander Grid.Row="0" Margin="0,0,0,10" HorizontalAlignment="Stretch">
            <Expander.Header>

                <controls:WrapPanel Style="{StaticResource UnifiedToolbarStyle}">

                    <ProgressRing Visibility="Collapsed" IsActive="False" />

                    <DropDownButton x:Uid="ExtraActionsDropDownButton">
                        <DropDownButton.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE712;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </DropDownButton.ContentTemplate>
                        <DropDownButton.Flyout>

                            <MenuFlyout Placement="Bottom">

                                <MenuFlyoutItem x:Uid="SelectAllMenuFlyoutItem" Click="{x:Bind ViewModel.SelectAll_Click_EventLogs}">
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xE762;"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>

                                <MenuFlyoutItem x:Uid="DeSelectAllMenuFlyoutItem" Click="{x:Bind ViewModel.DeSelectAll_Click_EventLogs}">
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xE8E6;"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>

                                <MenuFlyoutItem Click="{x:Bind ViewModel.ClearEventLogsDataButton_Click}" x:Uid="ClearDataMenuFlyoutItem">
                                    <MenuFlyoutItem.Icon>
                                        <SymbolIcon Symbol="Delete" />
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>

                            </MenuFlyout>

                        </DropDownButton.Flyout>
                    </DropDownButton>

                    <TextBox Text="{x:Bind ViewModel.EventLogsAllFileIdentitiesSearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         x:Uid="SearchBoxTextBox"
                         VerticalAlignment="Center"
                         VerticalContentAlignment="Center" />

                    <!-- Columns Selection Button -->
                    <customUI:ColumnSelector ItemsSource="{x:Bind ViewModel.EventLogsColumnManager.ColumnSelectionItems, Mode=OneWay}" />

                </controls:WrapPanel>

            </Expander.Header>

            <Expander.Content>

                <controls:WrapPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center" HorizontalSpacing="10" VerticalSpacing="10">

                    <Button Click="{x:Bind ViewModel.ExportEventLogsToJsonButton_Click}"
                            x:Uid="ExportToJSONButton">
                        <Button.ContentTemplate>
                            <DataTemplate x:DataType="x:String">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE96A;" FontSize="16"/>
                                    <TextBlock Text="{x:Bind}"/>
                                </StackPanel>
                            </DataTemplate>
                        </Button.ContentTemplate>
                    </Button>

                </controls:WrapPanel>

            </Expander.Content>
        </Expander>

        <customUI:ListViewV2 x:Name="FileIdentitiesListView"
                             RegistryKey="Allow_New_Apps_EventLogs_ScanResults"
                             Grid.Row="1"
                             SelectionMode="Extended"
                             ItemsSource="{x:Bind ViewModel.EventLogsFileIdentities, Mode=OneWay}">

            <customUI:ListViewV2.Header>

                <Border CornerRadius="5" Background="Black" customUI:StickyHeaderBehaviorV2.IsEnabled="True">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <!-- Binding Mode must be TwoWay for resizing to work from UI back to ViewModel. Binding to .Width property prevents CollectionChanged re-entrancy. -->
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[0].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[1].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[2].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[3].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[4].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[5].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[6].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[7].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[8].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[9].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[10].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[11].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[12].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[13].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[14].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[15].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[16].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[17].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[18].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[19].Width, Mode=TwoWay}" />
                            <ColumnDefinition Width="{x:Bind ViewModel.EventLogsColumnManager.ColumnWidths[20].Width, Mode=TwoWay}" />
                        </Grid.ColumnDefinitions>

                        <!-- Header Buttons -->
                        <Button x:Uid="FileNameColumnHeaderBtn" Tag="FileName" Grid.Column="0" Margin="10,0,2,0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[0], Mode=OneWay}" />
                        <Button x:Uid="TimeCreatedColumnHeaderBtn" Tag="TimeCreated" Grid.Column="1" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[1], Mode=OneWay}" />
                        <Button x:Uid="SignatureStatusColumnHeaderBtn" Tag="SignatureStatus" Grid.Column="2" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[2], Mode=OneWay}" />
                        <Button x:Uid="ActionColumnHeaderBtn" Tag="Action" Grid.Column="3" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[3], Mode=OneWay}" />
                        <Button x:Uid="OriginalFileNameColumnHeaderBtn" Tag="OriginalFileName" Grid.Column="4" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[4], Mode=OneWay}" />
                        <Button x:Uid="InternalNameColumnHeaderBtn" Tag="InternalName" Grid.Column="5" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[5], Mode=OneWay}" />
                        <Button x:Uid="FileDescriptionColumnHeaderBtn" Tag="FileDescription" Grid.Column="6" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[6], Mode=OneWay}" />
                        <Button x:Uid="ProductNameColumnHeaderBtn" Tag="ProductName" Grid.Column="7" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[7], Mode=OneWay}" />
                        <Button x:Uid="FileVersionColumnHeaderBtn" Tag="FileVersion" Grid.Column="8" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[8], Mode=OneWay}" />
                        <Button x:Uid="PackageFamilyNameColumnHeaderBtn" Tag="PackageFamilyName" Grid.Column="9" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[9], Mode=OneWay}" />
                        <Button x:Uid="SHA256HashColumnHeaderBtn" Tag="SHA256Hash" Grid.Column="10" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[10], Mode=OneWay}" />
                        <Button x:Uid="SHA1HashColumnHeaderBtn" Tag="SHA1Hash" Grid.Column="11" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[11], Mode=OneWay}" />
                        <Button x:Uid="SigningScenarioColumnHeaderBtn" Tag="SISigningScenario" Grid.Column="12" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[12], Mode=OneWay}" />
                        <Button x:Uid="FilePathColumnHeaderBtn" Tag="FilePath" Grid.Column="13" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[13], Mode=OneWay}" />
                        <Button x:Uid="SHA1FlatHashColumnHeaderBtn" Tag="SHA1FlatHash" Grid.Column="14" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[14], Mode=OneWay}" />
                        <Button x:Uid="SHA256FlatHashColumnHeaderBtn" Tag="SHA256FlatHash" Grid.Column="15" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[15], Mode=OneWay}" />
                        <Button x:Uid="FilePublishersColumnHeaderBtn" Tag="FilePublishersToDisplay" Grid.Column="16" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[16], Mode=OneWay}" />
                        <Button x:Uid="OpusDataColumnHeaderBtn" Tag="Opus" Grid.Column="17" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[17], Mode=OneWay}" />
                        <Button x:Uid="PolicyGUIDColumnHeaderBtn" Tag="PolicyGUID" Grid.Column="18" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[18], Mode=OneWay}" />
                        <Button x:Uid="PolicyNameColumnHeaderBtn" Tag="PolicyName" Grid.Column="19" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[19], Mode=OneWay}" />
                        <Button x:Uid="ComputerNameColumnHeaderBtn" Tag="ComputerName" Grid.Column="20" Margin="0" FontFamily="{x:Bind ViewModel.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewHeaderButton}" Click="{x:Bind ViewModel.HeaderColumnSortingButton_Click_EventLogs}" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[20], Mode=OneWay}" />

                        <!-- GridSplitters between columns -->
                        <controls:GridSplitter Grid.Column="1" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[22], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="2" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[23], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="3" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[24], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="4" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[25], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="5" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[26], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="6" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[27], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="7" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[28], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="8" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[29], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="9" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[30], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="10" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[31], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="11" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[32], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="12" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[33], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="13" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[34], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="14" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[35], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="15" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[36], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="16" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[37], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="17" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[38], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="18" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[39], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="19" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[40], Mode=OneWay}" />
                        <controls:GridSplitter Grid.Column="20" Visibility="{x:Bind ViewModel.EventLogsColumnManager.ColumnVisibilities[41], Mode=OneWay}" />
                    </Grid>
                </Border>
            </customUI:ListViewV2.Header>

            <!-- DataTemplate for ListView items -->
            <customUI:ListViewV2.ItemTemplate>
                <DataTemplate x:DataType="intelgathering:FileIdentity" xmlns:VMs="using:AppControlManager.ViewModels">
                    <!-- Setting Background="Transparent" on the Grid makes it hit-test visible, meaning that even areas without any child elements (like empty spaces in the column) will respond to pointer events.  -->
                    <Grid Background="Transparent">
                        <Grid.ContextFlyout>
                            <MenuFlyout>

                                <MenuFlyoutItem x:Uid="OpenInFileExplorer" Click="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM._OpenInFileExplorer_EventLogs}">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Key="O" Modifiers="Control" Invoked="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM._OpenInFileExplorerShortCut_EventLogs}"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xEC50;" />
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>

                                <MenuFlyoutItem x:Uid="DeleteRow" Click="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.ListViewFlyoutMenuDelete_Click_EventLogs}">
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xE74D;" />
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>

                                <MenuFlyoutItem x:Uid="CopyRow" Click="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.ListViewFlyoutMenuCopy_Click_EventLogs}">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Key="C" Modifiers="Control" Invoked="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.CtrlC_Invoked_EventLogs}"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xE8C8;" />
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>

                                <MenuFlyoutSubItem x:Uid="CopyIndividualItems">
                                    <MenuFlyoutSubItem.Icon>
                                        <FontIcon Glyph="&#xE8C8;" />
                                    </MenuFlyoutSubItem.Icon>

                                    <MenuFlyoutSubItem.Items>

                                        <MenuFlyoutItem x:Uid="FileNameHeader" Tag="FileName" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="TimeCreatedHeader" Tag="TimeCreated" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SignatureStatusHeader" Tag="SignatureStatus" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="ActionHeader" Tag="Action" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="OriginalFileNameHeader" Tag="OriginalFileName" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="InternalNameHeader" Tag="InternalName" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="FileDescriptionHeader" Tag="FileDescription" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="ProductNameHeader" Tag="ProductName" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="FileVersionHeader" Tag="FileVersion" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="PackageFamilyNameHeader" Tag="PackageFamilyName" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SHA256HashHeader" Tag="SHA256Hash" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SHA1HashHeader" Tag="SHA1Hash" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SigningScenarioHeader" Tag="SISigningScenario" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="FilePathHeader" Tag="FilePath" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SHA1FlatHashHeader" Tag="SHA1FlatHash" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="SHA256FlatHashHeader" Tag="SHA256FlatHash" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="FilePublishersHeader" Tag="FilePublishersToDisplay" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="OpusDataHeader" Tag="Opus" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="PolicyGUIDHeader" Tag="PolicyGUID" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="PolicyNameHeader" Tag="PolicyName" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Uid="ComputerNameHeader" Tag="ComputerName" Click="CopyToClipboard_Click">
                                            <MenuFlyoutItem.Icon>
                                                <FontIcon Glyph="&#xE8C8;" />
                                            </MenuFlyoutItem.Icon>
                                        </MenuFlyoutItem>

                                    </MenuFlyoutSubItem.Items>

                                </MenuFlyoutSubItem>
                            </MenuFlyout>
                        </Grid.ContextFlyout>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[0].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[1].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[2].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[3].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[4].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[5].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[6].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[7].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[8].Width, Mode=OneWay}" />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[9].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[10].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[11].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[12].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[13].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[14].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[15].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[16].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[17].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[18].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[19].Width, Mode=OneWay}"  />
                            <ColumnDefinition Width="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnWidths[20].Width, Mode=OneWay}"  />
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="{x:Bind FileName}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="0" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[0], Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind TimeCreated}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="1" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[1], Mode=OneWay}"/>
                        <TextBlock x:Phase="1" Text="{x:Bind SignatureStatus_String}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="2" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[2], Mode=OneWay}"/>
                        <TextBlock x:Phase="1" Text="{x:Bind Action_String}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="3" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[3], Mode=OneWay}"/>
                        <TextBlock x:Phase="1" Text="{x:Bind OriginalFileName}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="4" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[4], Mode=OneWay}"/>
                        <TextBlock x:Phase="1" Text="{x:Bind InternalName}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="5" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[5], Mode=OneWay}"/>
                        <TextBlock x:Phase="2" Text="{x:Bind FileDescription}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="6" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[6], Mode=OneWay}"/>
                        <TextBlock x:Phase="2" Text="{x:Bind ProductName}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="7" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[7], Mode=OneWay}"/>
                        <TextBlock x:Phase="2" Text="{x:Bind FileVersion_String}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="8" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[8], Mode=OneWay}"/>
                        <TextBlock x:Phase="3" Text="{x:Bind PackageFamilyName}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="9" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[9], Mode=OneWay}"/>
                        <TextBlock x:Phase="4" Text="{x:Bind SHA256Hash}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="10" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[10], Mode=OneWay}"/>
                        <TextBlock x:Phase="4" Text="{x:Bind SHA1Hash}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="11" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[11], Mode=OneWay}"/>
                        <TextBlock x:Phase="2" Text="{x:Bind SISigningScenario}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="12" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[12], Mode=OneWay}"/>
                        <TextBlock x:Phase="3" Text="{x:Bind FilePath}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="13" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[13], Mode=OneWay}"/>
                        <TextBlock x:Phase="4" Text="{x:Bind SHA1FlatHash}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="14" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[14], Mode=OneWay}"/>
                        <TextBlock x:Phase="4" Text="{x:Bind SHA256FlatHash}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="15" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[15], Mode=OneWay}"/>
                        <TextBlock x:Phase="2" Text="{x:Bind FilePublishersToDisplay}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="16" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[16], Mode=OneWay}"/>
                        <TextBlock x:Phase="2" Text="{x:Bind Opus}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="17" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[17], Mode=OneWay}"/>
                        <TextBlock x:Phase="3" Text="{x:Bind PolicyGUID}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="18" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[18], Mode=OneWay}"/>
                        <TextBlock x:Phase="3" Text="{x:Bind PolicyName}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="19" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[19], Mode=OneWay}"/>
                        <TextBlock x:Phase="3" Text="{x:Bind ComputerName}" FontFamily="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.AppSettings.ListViewFontFamily, Mode=OneWay}" Style="{StaticResource ListViewCellTextBlock}" Grid.Column="20" Visibility="{x:Bind VMs:ViewModelProvider.AllowNewAppsVM.EventLogsColumnManager.ColumnVisibilities[20], Mode=OneWay}"/>
                    </Grid>
                </DataTemplate>
            </customUI:ListViewV2.ItemTemplate>
        </customUI:ListViewV2>

    </Grid>
</Page>
